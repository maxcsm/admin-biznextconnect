"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5968],{5968:(I,p,s)=>{s.r(p),s.d(p,{MessagesPageModule:()=>c});var g=s(6895),_=s(433),i=s(5035),b=s(4126),n=s(655),v=s(5280),e=s(8256),y=s(1053),P=s(7330);function w(a,r){if(1&a&&(e.TgZ(0,"div",15),e._UZ(1,"img",16),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.s9C("src",t.to_id.user_avatar,e.LSH)}}function Z(a,r){if(1&a&&(e.TgZ(0,"ion-text")(1,"h5"),e._uU(2),e.qZA(),e.TgZ(3,"b")(4,"small"),e._uU(5),e.qZA()(),e._UZ(6,"br"),e.TgZ(7,"small"),e._uU(8," le "),e.TgZ(9,"b"),e._uU(10),e.ALo(11,"date"),e.qZA(),e._uU(12," \xe0 "),e.TgZ(13,"b"),e._uU(14),e.ALo(15,"date"),e.qZA()(),e._UZ(16,"br"),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(2),e.AsE("",t.to_id.firstname," ",t.to_id.lastname," "),e.xp6(3),e.hij("",t.last_message.body," "),e.xp6(5),e.Oqu(e.xi3(11,5,t.last_message.created_at,"dd/MM/yyyy")),e.xp6(4),e.hij(" ",e.xi3(15,8,t.last_message.created_at,"HH:mm")," ")}}function j(a,r){if(1&a&&(e.TgZ(0,"div",15),e._UZ(1,"img",16),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.s9C("src",t.to_id.user_avatar,e.LSH)}}function O(a,r){if(1&a&&(e.TgZ(0,"ion-text")(1,"h5"),e._uU(2),e.qZA(),e.TgZ(3,"b"),e._uU(4),e.qZA(),e._UZ(5,"br"),e.TgZ(6,"small"),e._uU(7," le "),e.TgZ(8,"b"),e._uU(9),e.ALo(10,"date"),e.qZA(),e._uU(11," \xe0 "),e.TgZ(12,"b"),e._uU(13),e.ALo(14,"date"),e.qZA()(),e._UZ(15,"br"),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(2),e.AsE("",t.to_id.firstname," ",t.to_id.lastname," "),e.xp6(2),e.hij("",t.last_message.body," "),e.xp6(5),e.Oqu(e.xi3(10,5,t.last_message.created_at,"dd/MM/yyyy")),e.xp6(4),e.hij(" ",e.xi3(14,8,t.last_message.created_at,"HH:mm")," ")}}function x(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"ion-item",12),e.NdJ("click",function(o){const f=e.CHM(t).$implicit,m=e.oxw();return e.KtG(m.view(o,f))}),e.YNc(1,w,2,1,"div",13),e.YNc(2,Z,17,11,"ion-text",14),e.YNc(3,j,2,1,"div",13),e.YNc(4,O,16,11,"ion-text",14),e.qZA()}if(2&a){const t=r.$implicit,u=e.oxw();e.Q6J("color",0==t.last_message.seen&&t.from_id.id!==u.iduser?"dark":"medium"),e.xp6(1),e.Q6J("ngIf",u.message.from_id!==u.iduser),e.xp6(1),e.Q6J("ngIf",u.message.to_id!==u.iduser),e.xp6(1),e.Q6J("ngIf",u.message.from_id==u.iduser),e.xp6(1),e.Q6J("ngIf",u.message.from_id==u.iduser)}}function T(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"ion-list",17),e._UZ(1,"img",18),e.TgZ(2,"h1"),e._uU(3,"Oups !"),e.qZA(),e.TgZ(4,"p"),e._uU(5,"Aucun messages trouv\xe9"),e.qZA(),e.TgZ(6,"ion-button",2),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.addthread())}),e._uU(7,"\xc9crire un nouveau message"),e.qZA()()}}class d{constructor(r,t,u,o,h,f,m,A,M,C){Object.defineProperty(this,"navCtrl",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"popoverCtrl",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"alertController",{enumerable:!0,configurable:!0,writable:!0,value:u}),Object.defineProperty(this,"menu",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"redditService",{enumerable:!0,configurable:!0,writable:!0,value:h}),Object.defineProperty(this,"router",{enumerable:!0,configurable:!0,writable:!0,value:f}),Object.defineProperty(this,"toastCtrl",{enumerable:!0,configurable:!0,writable:!0,value:m}),Object.defineProperty(this,"modalController",{enumerable:!0,configurable:!0,writable:!0,value:A}),Object.defineProperty(this,"localStore",{enumerable:!0,configurable:!0,writable:!0,value:M}),Object.defineProperty(this,"loadingCtrl",{enumerable:!0,configurable:!0,writable:!0,value:C}),Object.defineProperty(this,"pages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"posts",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"postspush",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"datapost",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"region",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"currentpage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"category",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"table",{enumerable:!0,configurable:!0,writable:!0,value:"threads_user_id"}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"word",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"wordid",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"total",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"last_page",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"per_page",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"order_id",{enumerable:!0,configurable:!0,writable:!0,value:"id"}),Object.defineProperty(this,"order_by",{enumerable:!0,configurable:!0,writable:!0,value:"desc"}),Object.defineProperty(this,"tabBarElement",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supplier",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"loader",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"iduser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"token",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"idtoken",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.page=1}ngOnInit(){return(0,n.mG)(this,void 0,void 0,function*(){})}ionViewWillEnter(){return(0,n.mG)(this,void 0,void 0,function*(){this.iduser=this.localStore.getItem("iduser"),this.getData()})}onSearchChange(r){this.filter=r.target.value,this.page=1,setTimeout(()=>{this.getData()},500)}onCancelword(r){}getData(){return(0,n.mG)(this,void 0,void 0,function*(){this.page=1,this.redditService.getDataBypageByUser(this.iduser,this.page,this.table,this.per_page,this.order_id,this.order_by,this.category,this.status,this.filter).subscribe(r=>{console.log(r),this.message=r.data,this.total=r.total,this.per_page=r.per_page,this.currentpage=r.current_page,this.last_page=r.last_page})})}doInfinite(r){this.currentpage<this.last_page?(this.page=this.page+1,setTimeout(()=>{this.redditService.getDataBypageByUser(this.iduser,this.page,this.table,this.per_page,this.order_id,this.order_by,this.category,this.status,this.filter).subscribe(t=>{let u=t.data;for(let o of u)this.message.push(o);this.total=t.total,this.currentpage=t.current_page,this.last_page=t.last_page}),r.target.complete()},1e3)):setTimeout(()=>{r.target.complete()},1e3)}doRefresh(r){setTimeout(()=>{this.getData(),r.target.complete()},2e3)}view(r,t){return(0,n.mG)(this,void 0,void 0,function*(){if(console.log(t),0==t.last_message.seen&&t.from_id.id!==this.iduser){console.log("read"),console.log("UPDATE MESSAGE");var u=JSON.stringify({seen:1});console.log(u),this.redditService.update("messages",t.last_message.id,u).toPromise().then(o=>(0,n.mG)(this,void 0,void 0,function*(){console.log(o),setTimeout(()=>{this.router.navigateByUrl("/message/"+t.thread_id)},400)}))}else setTimeout(()=>{this.router.navigateByUrl("/message/"+t.thread_id)},400)})}addthread(){return(0,n.mG)(this,void 0,void 0,function*(){yield(yield this.modalController.create({component:v.p})).present()})}closeModal(){return(0,n.mG)(this,void 0,void 0,function*(){yield this.modalController.dismiss(void 0,"close")})}}Object.defineProperty(d,"\u0275fac",{enumerable:!0,configurable:!0,writable:!0,value:function(r){return new(r||d)(e.Y36(i.SH),e.Y36(i.Dh),e.Y36(i.Br),e.Y36(i._q),e.Y36(y.I),e.Y36(b.F0),e.Y36(i.yF),e.Y36(i.IN),e.Y36(P.C),e.Y36(i.HT))}}),Object.defineProperty(d,"\u0275cmp",{enumerable:!0,configurable:!0,writable:!0,value:e.Xpm({type:d,selectors:[["app-messages"]],decls:20,vars:2,consts:[["color","secondary"],["slot","end"],[3,"click"],["name","add-circle"],["color","tertiary"],["justify-content-center",""],["size-md","3","size-lg","3","size-xs","12"],["align-self-center","","size-md","6","size-lg","6","size-xs","12"],["slot","fixed",3,"ionRefresh"],[3,"color","click",4,"ngFor","ngForOf"],[3,"ionInfinite"],["class","ion-margin-top ion-text-center",4,"ngIf"],[3,"color","click"],["class","border-blue","slot","start",4,"ngIf"],[4,"ngIf"],["slot","start",1,"border-blue"],["width","40px","height","40px",3,"src"],[1,"ion-margin-top","ion-text-center"],["src","assets/not-found.png","width","200px"]],template:function(r,t){1&r&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e._uU(3,"Chat"),e.qZA(),e.TgZ(4,"ion-buttons",1)(5,"ion-button",2),e.NdJ("click",function(){return t.addthread()}),e._UZ(6,"ion-icon",3),e._uU(7," Nouveau "),e.qZA()()()(),e.TgZ(8,"ion-content",4)(9,"ion-row",5),e._UZ(10,"ion-col",6),e.TgZ(11,"ion-col",7)(12,"ion-refresher",8),e.NdJ("ionRefresh",function(o){return t.doRefresh(o)}),e._UZ(13,"ion-refresher-content"),e.qZA(),e.TgZ(14,"ion-list"),e.YNc(15,x,5,5,"ion-item",9),e.qZA(),e.TgZ(16,"ion-infinite-scroll",10),e.NdJ("ionInfinite",function(o){return t.doInfinite(o)}),e._UZ(17,"ion-infinite-scroll-content"),e.qZA(),e.YNc(18,T,8,0,"ion-list",11),e.qZA(),e._UZ(19,"ion-col",6),e.qZA()()),2&r&&(e.xp6(15),e.Q6J("ngForOf",t.message),e.xp6(3),e.Q6J("ngIf",0==t.message))},dependencies:[g.sg,g.O5,i.YG,i.Sm,i.wI,i.W2,i.Gu,i.gu,i.ju,i.MB,i.Ie,i.q_,i.nJ,i.Wo,i.Nd,i.yW,i.wd,i.sr,g.uU]})});const U=[{path:"",component:d}];class l{}Object.defineProperty(l,"\u0275fac",{enumerable:!0,configurable:!0,writable:!0,value:function(r){return new(r||l)}}),Object.defineProperty(l,"\u0275mod",{enumerable:!0,configurable:!0,writable:!0,value:e.oAB({type:l})}),Object.defineProperty(l,"\u0275inj",{enumerable:!0,configurable:!0,writable:!0,value:e.cJS({imports:[b.Bz.forChild(U),b.Bz]})});class c{}Object.defineProperty(c,"\u0275fac",{enumerable:!0,configurable:!0,writable:!0,value:function(r){return new(r||c)}}),Object.defineProperty(c,"\u0275mod",{enumerable:!0,configurable:!0,writable:!0,value:e.oAB({type:c})}),Object.defineProperty(c,"\u0275inj",{enumerable:!0,configurable:!0,writable:!0,value:e.cJS({imports:[g.ez,_.u5,i.Pc,l]})})}}]);