"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[317],{317:(F,f,n)=>{n.r(f),n.d(f,{MessagenewPageModule:()=>l});var m=n(6895),a=n(433),t=n(5035),b=n(4126),g=n(655),e=n(8256),p=n(1053),v=n(849),h=n(529),y=n(7330);const P=function(){return["/tabs/chat"]};class d{constructor(r,i,u,c,O,j,M,Z,C,T){Object.defineProperty(this,"navCtrl",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"alertController",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"loadingController",{enumerable:!0,configurable:!0,writable:!0,value:u}),Object.defineProperty(this,"redditService",{enumerable:!0,configurable:!0,writable:!0,value:c}),Object.defineProperty(this,"toastCtrl",{enumerable:!0,configurable:!0,writable:!0,value:O}),Object.defineProperty(this,"route",{enumerable:!0,configurable:!0,writable:!0,value:j}),Object.defineProperty(this,"router",{enumerable:!0,configurable:!0,writable:!0,value:M}),Object.defineProperty(this,"storage",{enumerable:!0,configurable:!0,writable:!0,value:Z}),Object.defineProperty(this,"http",{enumerable:!0,configurable:!0,writable:!0,value:C}),Object.defineProperty(this,"localStore",{enumerable:!0,configurable:!0,writable:!0,value:T}),Object.defineProperty(this,"file",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"push",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"posts",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"item",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"network_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"idtoken",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"token",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstname",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lastname",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"iduser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"idusermessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"title",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"message_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"table",{enumerable:!0,configurable:!0,writable:!0,value:"messages"}),Object.defineProperty(this,"table2",{enumerable:!0,configurable:!0,writable:!0,value:"savemessageapp"}),Object.defineProperty(this,"tokenid",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tokenvalue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"patient_file_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filedatares",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"read",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ngOnInit(){this.iduser=this.localStore.getItem("iduser"),this.route.params.subscribe(r=>{this.idusermessage=r.id,this.firstname=r.firstname,this.lastname=r.lastname})}sendMessage(){var r=JSON.stringify({from_id:this.iduser,to_id:this.idusermessage,body:this.content,thread_id:null,type_id:0,depth:1});console.log(r),this.redditService.addPost("messageNew",r).toPromise().then(i=>(0,g.mG)(this,void 0,void 0,function*(){console.log(i),this.message_id=i.message.thread_id,(yield this.toastCtrl.create({cssClass:"bg-profile",message:"Message envoy\xe9",duration:3e3,position:"bottom"})).present(),setTimeout(()=>(0,g.mG)(this,void 0,void 0,function*(){this.content="",this.router.navigateByUrl("/tabs")}),400)}))}onFileChange(r){this.file=r.target.files[0],this.submitForm()}submitForm(){return(0,g.mG)(this,void 0,void 0,function*(){let r=new FormData;r.append("file",this.file,this.file.name),r.append("token_id",this.tokenid),r.append("token_value",this.tokenvalue),console.log(r),this.http.post("https://app.monkeydoc.com/service/uploadPatientFile.json",r).toPromise().then(i=>{this.filedatares=[i],this.patient_file_id=this.filedatares[0].data.data.patient_file_id,setTimeout(()=>{},800)},i=>{console.log(i)})})}}Object.defineProperty(d,"\u0275fac",{enumerable:!0,configurable:!0,writable:!0,value:function(r){return new(r||d)(e.Y36(t.SH),e.Y36(t.Br),e.Y36(t.HT),e.Y36(p.I),e.Y36(t.yF),e.Y36(b.gz),e.Y36(b.F0),e.Y36(v.K),e.Y36(h.eN),e.Y36(y.C))}}),Object.defineProperty(d,"\u0275cmp",{enumerable:!0,configurable:!0,writable:!0,value:e.Xpm({type:d,selectors:[["app-messagenew"]],decls:31,vars:6,consts:[["color","primary"],["slot","start"],[3,"routerLink"],["color","light"],["color","primary",1,"ion-justify-content-center"],["size-md","6","size-lg","4","size-xs","12"],["align-self-center","","size-md","6","size-lg","4","size-xs","12"],["no-border",""],["form","ngForm"],["position","floating"],["rows","4","name","content","type","text","placeholder","Votre message ici","minlength","10","required","",3,"ngModel","ngModelChange"],[2,"display","none"],["slot","icon-only","name","attach"],["type","file",3,"change"],["size","medium","expand","full","shape","round","color","primary","type","submit",3,"disabled","click"]],template:function(r,i){if(1&r&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar",0)(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5," Nouveau message "),e.qZA()()(),e.TgZ(6,"ion-content",3)(7,"ion-grid")(8,"ion-row",4),e._UZ(9,"ion-col",5),e.TgZ(10,"ion-col",6)(11,"ion-list",7)(12,"ion-card")(13,"ion-card-content"),e._uU(14," Envoyer un message \xe0 : "),e.TgZ(15,"b"),e._uU(16),e.qZA()()(),e.TgZ(17,"form",null,8)(19,"ion-item")(20,"ion-label",9),e._uU(21," Message "),e.qZA(),e.TgZ(22,"ion-textarea",10),e.NdJ("ngModelChange",function(c){return i.content=c}),e.qZA()()(),e.TgZ(23,"ion-item",11)(24,"ion-buttons",1)(25,"ion-button"),e._UZ(26,"ion-icon",12),e.qZA()(),e.TgZ(27,"input",13),e.NdJ("change",function(c){return i.onFileChange(c)}),e.qZA()(),e.TgZ(28,"ion-button",14),e.NdJ("click",function(){return i.sendMessage()}),e._uU(29," Envoyer "),e.qZA()()(),e._UZ(30,"ion-col",5),e.qZA()()()),2&r){const u=e.MAs(18);e.xp6(3),e.Q6J("routerLink",e.DdM(5,P)),e.xp6(13),e.AsE(" ",i.firstname," ",i.lastname," "),e.xp6(6),e.Q6J("ngModel",i.content),e.xp6(6),e.Q6J("disabled",u.invalid)}},dependencies:[a._Y,a.JJ,a.JL,a.Q7,a.wO,a.On,a.F,t.oU,t.YG,t.Sm,t.PM,t.FN,t.wI,t.W2,t.jY,t.Gu,t.gu,t.Ie,t.Q$,t.q_,t.Nd,t.g2,t.wd,t.sr,t.j9,t.cs,t.YI,b.rH],styles:["ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{padding-top:20px;padding-bottom:20px;border-radius:10px;box-shadow:1px 1px 1px 2px #d7d7d7}"]})});const w=[{path:"",component:d}];class o{}Object.defineProperty(o,"\u0275fac",{enumerable:!0,configurable:!0,writable:!0,value:function(r){return new(r||o)}}),Object.defineProperty(o,"\u0275mod",{enumerable:!0,configurable:!0,writable:!0,value:e.oAB({type:o})}),Object.defineProperty(o,"\u0275inj",{enumerable:!0,configurable:!0,writable:!0,value:e.cJS({imports:[b.Bz.forChild(w),b.Bz]})});class l{}Object.defineProperty(l,"\u0275fac",{enumerable:!0,configurable:!0,writable:!0,value:function(r){return new(r||l)}}),Object.defineProperty(l,"\u0275mod",{enumerable:!0,configurable:!0,writable:!0,value:e.oAB({type:l})}),Object.defineProperty(l,"\u0275inj",{enumerable:!0,configurable:!0,writable:!0,value:e.cJS({imports:[m.ez,a.u5,t.Pc,o]})})}}]);